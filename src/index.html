<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¸”ë£¨ ì•„ì¹´ì´ë¸Œ ìƒì  ê³„ì‚°ê¸°</title>
    <style>
        /* --- ë¸”ë£¨ ì•„ì¹´ì´ë¸Œ í…Œë§ˆ ë³€ìˆ˜ --- */
        :root {
            --ba-blue: #128CFF;
            --ba-cyan: #00D1FF;
            --ba-dark: #2B3A42;
            --ba-bg: #F3F7F8;
            --ba-gray: #D0D7DB;
            --tab-active: #FFE500; /* í™œì„± íƒ­ (ë…¸ë‘) */
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--ba-bg);
            color: var(--ba-dark);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        .container {
            width: 100%;
            max-width: 800px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            padding: 25px;
            box-sizing: border-box;
        }

        h1 {
            text-align: center;
            color: var(--ba-blue);
            margin-bottom: 20px;
            font-weight: 800;
        }

        /* --- íƒ­ ìŠ¤íƒ€ì¼ --- */
        .shop-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            justify-content: center;
        }

        .tab-btn {
            padding: 12px 25px;
            border: 2px solid var(--ba-gray);
            background: white;
            border-radius: 30px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            flex: 1;
            max-width: 150px;
            text-align: center;
            color: #777;
        }

        .tab-btn.active {
            background-color: var(--tab-active);
            border-color: var(--tab-active);
            color: #333;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(255, 229, 0, 0.4);
        }

        /* --- ì•„ì´í…œ ê·¸ë¦¬ë“œ (4ì—´) --- */
        .shop-section {
            display: none; /* ê¸°ë³¸ ìˆ¨ê¹€ */
        }
        .shop-section.active {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 4ì—´ ê³ ì • */
            gap: 12px;
            margin-bottom: 30px;
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• (2ì—´ë¡œ ë³€ê²½) */
        @media (max-width: 600px) {
            .shop-section.active {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* --- ì•„ì´í…œ ì¹´ë“œ ë””ìì¸ --- */
        .item-card {
            border: 2px solid #eee;
            border-radius: 12px;
            padding: 12px;
            text-align: center;
            background: #fff;
            position: relative;
            transition: border-color 0.2s, background-color 0.2s;
        }

        /* ì„ íƒë˜ì—ˆì„ ë•Œ ìŠ¤íƒ€ì¼ */
        .item-card.selected {
            border-color: var(--ba-blue);
            background-color: #F0F9FF;
        }

        /* ì²´í¬ë°•ìŠ¤ ìœ„ì¹˜ */
        .item-checkbox {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 20px;
            height: 20px;
            cursor: pointer;
            z-index: 10;
        }

        /* ì´ë¯¸ì§€ ë°•ìŠ¤ (ìš”ì²­í•˜ì‹  ë¶€ë¶„) */
        .img-box {
            width: 60px;
            height: 60px;
            margin: 5px auto 10px;
            background: #fafafa;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #e0e0e0;
        }

        .img-box img {
            width: 100%;
            height: 100%;
            object-fit: contain; /* ì´ë¯¸ì§€ ë¹„ìœ¨ ìœ ì§€ */
            display: block;
        }

        /* ì¸í’‹ í•„ë“œ ìŠ¤íƒ€ì¼ */
        .item-inputs input {
            width: 100%;
            margin-top: 4px;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 6px;
            text-align: center;
            font-size: 0.85rem;
            box-sizing: border-box;
        }
        
        .item-inputs input:focus {
            border-color: var(--ba-blue);
            outline: none;
        }

        /* --- í•˜ë‹¨ ê³„ì‚°ê¸° ì˜ì—­ --- */
        .calc-area {
            background-color: #FAFAFA;
            border-top: 2px dashed var(--ba-gray);
            padding-top: 25px;
            margin-top: 20px;
        }

        .row { display: flex; gap: 15px; margin-bottom: 15px; }
        .col { flex: 1; }

        label { display: block; font-size: 0.9rem; font-weight: bold; color: #555; margin-bottom: 5px;}
        
        select, input.main-input {
            padding: 10px; border: 2px solid #ccc; border-radius: 8px; width: 100%; box-sizing: border-box;
        }

        .result-box {
            background: linear-gradient(135deg, var(--ba-blue), var(--ba-cyan));
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(18, 140, 255, 0.3);
        }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ’ ì´ë²¤íŠ¸ ìƒì  ê³„ì‚°ê¸°</h1>

    <div class="shop-tabs">
        <div class="tab-btn active" onclick="switchTab(0)">ì´ë²¤íŠ¸ ì¬í™” A</div>
        <div class="tab-btn" onclick="switchTab(1)">ì´ë²¤íŠ¸ ì¬í™” B</div>
        <div class="tab-btn" onclick="switchTab(2)">ì´ë²¤íŠ¸ ì¬í™” C</div>
    </div>

    <div id="shop-container"></div>

    <div class="calc-area">
        <div class="row">
            <div class="col">
                <label>í•„ìš”í•œ ì¬í™” (ìë™ í•©ì‚°)</label>
                <input type="number" id="targetAmount" class="main-input" readonly style="background:#eee; color:var(--ba-blue); font-weight:bold;">
            </div>
            <div class="col">
                <label>í˜„ì¬ ë³´ìœ ëŸ‰</label>
                <input type="number" id="currentAmount" class="main-input" placeholder="0" oninput="calculate()">
            </div>
        </div>

        <div class="row">
            <div class="col">
                <label>ìŠ¤í…Œì´ì§€ ë“œëëŸ‰ (ê¸°ë³¸)</label>
                <input type="number" id="baseDrop" class="main-input" value="30" oninput="calculate()">
            </div>
            <div class="col">
                <label>í•™ìƒ ë³´ë„ˆìŠ¤ í•©ê³„ (%)</label>
                <select id="bonusRate" onchange="calculate()">
                    <option value="0">0%</option>
                    <option value="20">20%</option>
                    <option value="40">40%</option>
                    <option value="60">60%</option>
                    <option value="80">80%</option>
                    <option value="100">100%</option>
                    <option value="120">120%</option>
                    <option value="140">140%</option>
                </select>
            </div>
        </div>

        <div class="result-box">
            <div style="font-size: 1.1rem; margin-bottom: 5px; opacity: 0.9;">í•„ìš” ì†Œíƒ• íšŸìˆ˜</div>
            <div id="result-runs" style="font-size: 2.5rem; font-weight: 900;">0íšŒ</div>
            <div id="result-ap" style="font-size: 1rem;">(ì´ 0 AP ì†Œëª¨)</div>
        </div>
    </div>
</div>

<script>
    // --- [ì¤‘ìš”] ì•„ì´í…œ ë°ì´í„° ì„¤ì • ---
    // ë‚˜ì¤‘ì— ì—¬ê¸°ë§Œ ìˆ˜ì •í•˜ë©´ ì´ë¯¸ì§€ê°€ ë°”ë€ë‹ˆë‹¤.
    // 3ê°œì˜ ì„¹ì…˜(íƒ­), ê° ì„¹ì…˜ì€ 16ê°œì˜ ì•„ì´í…œ(4x4)ì„ ê°€ì§‘ë‹ˆë‹¤.
    
    // ì´ë¯¸ì§€ ì˜ˆì‹œ URL (í…ŒìŠ¤íŠ¸ìš© í”Œë ˆì´ìŠ¤í™€ë”)
    const PLACEHOLDER_IMG = "src\\ë§ˆë¦¬ì—ìš©x ~.png"

    // 3ê°œì˜ ë°°ì—´(íƒ­) ìƒì„±. ê° ë°°ì—´ ì•ˆì— 16ê°œì˜ ê°ì²´ê°€ ë“¤ì–´ê°.
    const shopData = Array.from({ length: 3 }, (_, sectionIdx) => {
        return Array.from({ length: 16 }, (_, itemIdx) => ({
            id: `s${sectionIdx}_i${itemIdx}`,
            name: `ì•„ì´í…œ ${itemIdx + 1}`,
            price: 50,  // ê¸°ë³¸ ê°€ê²©
            qty: 1,     // ê¸°ë³¸ êµ¬ë§¤ ê°œìˆ˜
            img: PLACEHOLDER_IMG // ë‚˜ì¤‘ì— ì‹¤ì œ íŒŒì¼ ê²½ë¡œë¡œ ë³€ê²½ (ì˜ˆ: 'img/bd.png')
        }));
    });

    let currentTab = 0; // í˜„ì¬ ë³´ê³  ìˆëŠ” íƒ­ (0, 1, 2)
    
    // ê° íƒ­ë³„ ì´ í•„ìš”ëŸ‰ ì €ì¥ [ì¬í™”Aí•©ê³„, ì¬í™”Bí•©ê³„, ì¬í™”Cí•©ê³„]
    let tabTotals = [0, 0, 0];

    // --- 1. ì´ˆê¸°í™” í•¨ìˆ˜ (HTML ìƒì„±) ---
    function initShop() {
        const container = document.getElementById('shop-container');
        container.innerHTML = ''; // ì´ˆê¸°í™”

        shopData.forEach((items, sectionIdx) => {
            // ì„¹ì…˜ Div ìƒì„±
            const sectionDiv = document.createElement('div');
            sectionDiv.className = `shop-section ${sectionIdx === 0 ? 'active' : ''}`;
            sectionDiv.id = `section-${sectionIdx}`;

            // ì•„ì´í…œ ì¹´ë“œ 16ê°œ ìƒì„±
            items.forEach((item, itemIdx) => {
                const card = document.createElement('div');
                card.className = 'item-card';
                
                // HTML êµ¬ì¡° ì¡°ë¦½
                card.innerHTML = `
                    <input type="checkbox" class="item-checkbox" 
                           onchange="updateTotal(${sectionIdx}, this)">
                    
                    <div class="img-box">
                        <img src="${item.img}" alt="${item.name}">
                    </div>

                    <div class="item-inputs">
                        <input type="number" class="cost-input" placeholder="ê°€ê²©" value="${item.price}" 
                               oninput="updateTotal(${sectionIdx})">
                        <input type="number" class="qty-input" placeholder="ê°œìˆ˜" value="${item.qty}" 
                               oninput="updateTotal(${sectionIdx})">
                    </div>
                `;
                sectionDiv.appendChild(card);
            });

            container.appendChild(sectionDiv);
        });
    }

    // --- 2. íƒ­ ì „í™˜ ---
    function switchTab(idx) {
        currentTab = idx;

        // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
        document.querySelectorAll('.tab-btn').forEach((btn, i) => {
            btn.classList.toggle('active', i === idx);
        });

        // ì„¹ì…˜ ë³´ì´ê¸°/ìˆ¨ê¸°ê¸°
        document.querySelectorAll('.shop-section').forEach((sec, i) => {
            sec.classList.toggle('active', i === idx);
        });

        // ì…ë ¥ì¹¸ì— í•´ë‹¹ íƒ­ì˜ ì´í•© í‘œì‹œ
        document.getElementById('targetAmount').value = tabTotals[idx];
        calculate(); // ê²°ê³¼ ì¬ê³„ì‚°
    }

    // --- 3. í•©ê³„ ê³„ì‚° (ì²´í¬ë°•ìŠ¤/ì…ë ¥ê°’ ë³€ê²½ ì‹œ) ---
    function updateTotal(sectionIdx, checkbox = null) {
        const section = document.getElementById(`section-${sectionIdx}`);
        const cards = section.querySelectorAll('.item-card');
        let sum = 0;

        // ì²´í¬ë°•ìŠ¤ í´ë¦­ ì‹œ ì‹œê°ì  íš¨ê³¼ (íŒŒë€ í…Œë‘ë¦¬)
        if (checkbox) {
            const card = checkbox.closest('.item-card');
            if (checkbox.checked) card.classList.add('selected');
            else card.classList.remove('selected');
        }

        // ëª¨ë“  ì¹´ë“œ ìˆœíšŒí•˜ë©° ê³„ì‚°
        cards.forEach(card => {
            const isChecked = card.querySelector('.item-checkbox').checked;
            if (isChecked) {
                const cost = parseInt(card.querySelector('.cost-input').value) || 0;
                const qty = parseInt(card.querySelector('.qty-input').value) || 0;
                sum += (cost * qty);
            }
        });

        // í•´ë‹¹ íƒ­ì˜ ì´í•© ì €ì¥
        tabTotals[sectionIdx] = sum;

        // í˜„ì¬ ë³´ê³  ìˆëŠ” íƒ­ì´ë¼ë©´ í™”ë©´ ì—…ë°ì´íŠ¸
        if (currentTab === sectionIdx) {
            document.getElementById('targetAmount').value = sum;
            calculate();
        }
    }

    // --- 4. ì†Œíƒ• íšŸìˆ˜ ê³„ì‚° (ë¡œì§) ---
    function calculate() {
        const target = parseInt(document.getElementById('targetAmount').value) || 0;
        const current = parseInt(document.getElementById('currentAmount').value) || 0;
        const baseDrop = parseInt(document.getElementById('baseDrop').value) || 0;
        const bonusPercent = parseInt(document.getElementById('bonusRate').value) || 0;
        const apCost = 20;

        if (baseDrop <= 0) {
            document.getElementById('result-runs').innerText = "0íšŒ";
            return;
        }

        let needed = target - current;
        if (needed < 0) needed = 0;

        // ë³´ë„ˆìŠ¤ ê³„ì‚° (ì˜¬ë¦¼ ì²˜ë¦¬)
        const bonusAmount = Math.ceil(baseDrop * (bonusPercent / 100));
        const totalGain = baseDrop + bonusAmount;

        const runs = Math.ceil(needed / totalGain);
        const totalAp = runs * apCost;

        // ê²°ê³¼ ì¶œë ¥
        document.getElementById('result-runs').innerText = runs.toLocaleString() + "íšŒ";
        document.getElementById('result-ap').innerText = `(ì´ ${totalAp.toLocaleString()} AP ì†Œëª¨)`;
    }

    // ì‹œì‘
    initShop();
</script>

</body>
</html>