<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>블루 아카이브 상점 계산기</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="ap-widget">
    <div class="ap-header" onclick="toggleApWidget()" title="클릭해서 접기/펴기">
        <span>☕ AP 계산기</span>
        <span id="apToggleIcon" style="font-size:0.8rem;">▼</span>
    </div>
    
    <div id="apWidgetBody" class="ap-body">
        <div class="ap-input-row">
            <button class="ap-btn" onclick="adjustAp(-1)">-</button>
            <input type="number" id="curAp" placeholder="현재" oninput="calcAp()">
            <button class="ap-btn" onclick="adjustAp(1)">+</button>
            <span class="slash">/</span>
            <span class="max-ap-text">240</span>
        </div>
        <div id="apResult" class="ap-result">
            입력 대기 중...
        </div>
    </div>
</div>

<div class="container">
    <h1>이벤트 상점 계산기</h1>

    <div class="bonus-widget-container">
        <div class="bonus-toggle-header" onclick="toggleStudentSelector()">
            <div class="b-title">
                <span>🎓 학생 보너스 편성</span>
                <span id="totalStudentBonusBadge" class="total-badge">0%</span>
            </div>
            <span id="studentToggleIcon">▼</span>
        </div>

        <div id="studentSelectorBox" class="student-selector-body hidden">
            <div class="student-tabs">
                <div class="s-tab active">STRIKER</div>
                <div class="s-tab">SPECIAL</div>
            </div>
            <div id="student-grid" class="student-grid"></div>
        </div>
    </div>

    <div class="shop-tabs">
        <div class="tab-btn active" onclick="switchTab(0)">
            <img src="" class="tab-icon" alt="A" onerror="this.style.display='none'"> 
            상점 1
        </div>
        <div class="tab-btn" onclick="switchTab(1)">
            <img src="" class="tab-icon" alt="B" onerror="this.style.display='none'"> 
            상점 2
        </div>
        <div class="tab-btn" onclick="switchTab(2)">
            <img src="" class="tab-icon" alt="C" onerror="this.style.display='none'"> 
            상점 3
        </div>
    </div>

    <div id="shop-container"></div>

    <div class="calc-area">
        <div class="row inputs-row">
            <div class="col">
                <label>필요 재화</label>
                <input type="number" id="targetAmount" class="main-input" placeholder="0" oninput="manualTarget(this.value)">
            </div>
            <div class="col">
                <label>현재 보유</label>
                <input type="number" id="currentAmount" class="main-input" placeholder="0" oninput="updateCurrent(this.value)">
            </div>
            <div class="col">
                <label>보너스 합계 (%)</label>
                <select id="bonusRate" class="main-input" onchange="calculate()">
                    </select>
            </div>
        </div>

        <div class="row result-row">
            <div class="col">
                <label>추천 스테이지 (BEST)</label>
                <div class="recommend-box">
                    <div id="recStageName" class="rec-name">계산 중...</div>
                    <div id="recStageInfo" class="rec-info">-</div>
                </div>
            </div>
            
            <div class="col">
                <label>최종 결과</label>
                <div class="result-box compact-box">
                    <div class="res-mini-title">필요 소탕</div>
                    <div id="result-runs" class="res-value-sm">0회</div>
                    <div id="result-ap" class="res-sub-sm">(0 AP)</div>
                    <div id="result-surplus" class="res-surplus-sm"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="drop-info-area">
        <div class="filter-section">
            <div class="filter-header">
                <h3>🔍 계산할 지역 선택</h3>
                <div class="filter-btns">
                    <button class="small-btn" onclick="toggleAllStages(true)">전체 선택</button>
                    <button class="small-btn outline" onclick="toggleAllStages(false)">전체 해제</button>
                </div>
            </div>
            <div id="stage-filter-container" class="filter-grid"></div>
        </div>

        <h2>📅 스테이지 드랍 테이블</h2>
        <div class="drop-table-header">
            <span>지역명 (AP)</span>
            <span>드랍 아이템 (기본 + 보너스)</span>
        </div>
        <div id="drop-table-list"></div>
    </div>
</div>

<script src="script.js" defer></script>

</body>
</html>